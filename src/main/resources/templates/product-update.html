<!DOCTYPE html>
<html xmlns:th="http://www.thymeleaf.org">

<head>
    <title>Update Product - Famme</title>
    <script src="https://unpkg.com/htmx.org@1.9.2"></script>
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/web-awesome-ui@latest/web-awesome.css">
    <link rel="stylesheet" th:href="@{/css/product-update.css}">
</head>

<body>
    <div class="container">
        <a href="/products" class="back-link">
            ‚Üê Back to Products
        </a>

        <div class="header">
            <h1>‚úèÔ∏è Update Product</h1>
            <p>Edit product details and save changes</p>
        </div>

        <div class="form-container">
            <!-- Success/Error Message Display -->
            <div th:if="${message}" class="message-container"
                th:classappend="${messageType == 'success' ? 'success' : 'error'}">
                <div class="message-content">
                    <span class="message-icon" th:text="${messageType == 'success' ? '‚úÖ' : '‚ùå'}">üìù</span>
                    <span class="message-text" th:text="${message}">Message</span>
                </div>
            </div>

            <form th:action="@{/products/update/{id}(id=${product.externalId})}" method="post">
                <div class="form-grid">
                    <div class="form-group">
                        <label for="title">Product Title *</label>
                        <input type="text" id="title" name="title" th:value="${product.title}" required>
                    </div>

                    <div class="form-group">
                        <label for="vendor">Vendor</label>
                        <input type="text" id="vendor" name="vendor" th:value="${product.vendor}">
                    </div>

                    <div class="form-group">
                        <label for="productType">Product Type</label>
                        <input type="text" id="productType" name="productType" th:value="${product.productType}">
                    </div>

                    <div class="form-group">
                        <label for="handle">Handle</label>
                        <input type="text" id="handle" name="handle" th:value="${product.handle}">
                    </div>

                    <div class="form-group full-width">
                        <label for="bodyHtml">Description</label>
                        <textarea id="bodyHtml" name="bodyHtml" th:text="${product.bodyHtml}"></textarea>
                    </div>

                    <div class="form-group full-width">
                        <label for="tags">Tags (comma-separated)</label>
                        <input type="text" id="tags" name="tags" th:value="${tagsString}"
                            placeholder="e.g., fashion, summer, casual">
                    </div>
                </div>

                <div class="button-group">
                    <a href="/products" class="wa-button wa-secondary">
                        ‚ùå Cancel
                    </a>
                    <button type="submit" class="wa-button wa-primary">
                        üíæ Update Product
                    </button>
                </div>
            </form>
        </div>
    </div>

    <script th:inline="javascript">
        // Auto-hide success messages after 5 seconds
        document.addEventListener('DOMContentLoaded', function () {
            const successMessages = document.querySelectorAll('.message-container.success');
            successMessages.forEach(function (message) {
                setTimeout(function () {
                    message.style.opacity = '0';
                    message.style.transform = 'translateY(-20px)';
                    setTimeout(function () {
                        message.remove();
                    }, 300);
                }, 5000);
            });
        });
    </script>
</body>

</html>